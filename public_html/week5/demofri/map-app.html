<!DOCTYPE html>
<html>
    <head>
        <title>Distance Map App</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style type="text/css">
            #map-canvas {
                width: 500px;
                height: 300px;
            }
        </style>        
    </head>
    <body>
        
        Start <input type="text" name="start" /> <br />
        End <input type="text" name="end" />
        
        <div id="map-canvas"></div>
        
        <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places"></script>
        <script type="text/javascript">
            
            
            var mapdata = {
              "user_coords" : {
                    "lat" : 0,
                    "lng" : 0,
                    "address" : ''
                }  
            };
            
            function init(){
                getUserLocation();
                
                console.log(mapdata);
            }
            
            google.maps.event.addDomListener(window, 'load', init);
            
            function getUserLocation() {                
                if ( "geolocation" in navigator ) {
                    navigator.geolocation.getCurrentPosition(function(position){
                        mapdata.user_coords.lat = position.coords.latitude;
                        mapdata.user_coords.lng = position.coords.longitude;
                        getUserAddress();
                    });
                }                
            }
            
            function getUserAddress() {
                var geocoder = new google.maps.Geocoder();
                
                var latlng = new google.maps.LatLng(mapdata.user_coords.lat, mapdata.user_coords.lng);
                
                geocoder.geocode({'latLng' : latlng}, function(results, status){
                   if ( status === google.maps.GeocoderStatus.OK ) {
                       console.log(results);
                        mapdata.user_coords.address = results[0].formatted_address;
                   } 
                });
            }
            
            
            
        </script>
    </body>
</html>
